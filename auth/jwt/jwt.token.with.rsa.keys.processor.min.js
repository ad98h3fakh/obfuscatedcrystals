"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JwtTokenWithRSAKeysProcessor=void 0;const common_1=require("@nestjs/common"),jwt_simple_1=require("jwt-simple"),jwt_token_processor_1=require("./jwt.token.processor");class JwtTokenWithRSAKeysProcessor extends jwt_token_processor_1.JwtTokenProcessor{constructor(e,o){super(new common_1.Logger(JwtTokenWithRSAKeysProcessor.name)),this.publicKey=e,this.privateKey=o}async validateToken(e){this.log.debug("Call validateToken");const[o,s]=this.parse(e);return"None"===o.alg?s:jwt_simple_1.decode(e,this.publicKey,!1,o.alg)}async createToken(e){this.log.debug("Call createToken");return jwt_simple_1.encode(e,this.privateKey,"RS256")}}exports.JwtTokenWithRSAKeysProcessor=JwtTokenWithRSAKeysProcessor;